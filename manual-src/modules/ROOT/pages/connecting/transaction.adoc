= Open a transaction
:tabs-sync-option:
:experimental:

TypeDB uses transactions for all database queries to provide xref:home::acid.adoc[ACID guarantees].
Two transaction types exist: `read` and `write`.
Read transactions, while faster and supporting inference, do not permit alterations to the database.

This guide covers opening a transaction and other transaction management operations with Studio,
Console, or one of the drivers.
Studio provides automated transaction control, so you don't need to open transactions manually.

To open a transaction, you need an open session.
For more information on how to open a session, see the xref:manual::connecting/session.adoc[] page.

== Open a new transaction

To open a transaction, you need to select a transaction type and use an open session.
Optionally, you can set transaction options to alter values by default.

[tabs]
====
Studio::
+
--
Studio controls transactions automatically when you run a query.

You can select a transaction type for queries with a `write`/`read` selector in the top toolbar:
image:manual::icons/transaction-write.png[session type selector].
For the transaction type selector to be active, you need to connect Studio to TypeDB
and select a database from a drop-down list in the top toolbar.
--

Console::
+
--
Use the `transaction` keyword with the database name, xref:manual::connecting/session.adoc[session] type,
and transaction type, for example:

.Open a transaction
[,bash]
----
transaction db1 schema write
----
--
====

xref:drivers::overview.adoc[TypeDB drivers]
provide the most flexible approach to managing transactions via native API by manually opening them:

[tabs]
====
Rust::
+
--
.Open a transaction
[,rust]
----
let tx = session.transaction(TransactionType::Write)?;
----
--

Python::
+
--
.Open a transaction
[,python]
----
tx = session.transaction(TransactionType.WRITE)
----
--

Java::
+
--
.Open a transaction
[,java]
----
TypeDBTransaction tx = session.transaction(TypeDBTransaction.Type.WRITE);
----
--

Node.js::
+
--
.Open a transaction
[,js]
----
tx = await session.transaction(TransactionType.WRITE);
----
--

C++::
+
--
.Open a transaction
[,cpp]
----
auto tx = session.transaction(TypeDB::TransactionType::WRITE, options);
----
--
====

To see how to control transaction further, see <<_transaction_control,below>>.

After connecting to a server, opening a
xref:connecting/session.adoc[session] and a xref:manual::connecting/transaction.adoc[transaction],
see how to xref:manual::defining/overview.adoc[Define a schema] of a database.

[#_transaction_control]
== Transaction control

An open transaction can be <<_close_a_transaction,closed>>, <<_commit_a_transaction,committed>>, or even rolled back.

[#_close_a_transaction]
=== Close a transaction

Closing transaction doesn't save any changes made within the transaction.

To close a transaction, follow the steps below:

[tabs]
====
Studio::
+
--
In the top toolbar click the btn:[Close Transaction] button with the red cross icon:
image:home::studio-icons/close.png[].

The button is active only when a transaction is open.
--

Console::
+
--
Use the following command in Console's transaction input:

.Close a transaction
[,bash]
----
close
----
--
====

To programmatically close a transaction, use xref:drivers::overview.adoc[TypeDB drivers]:

[tabs]
====
Rust::
+
--
A transaction is automatically closed when the variable containing it is dropped from memory.

To explicitly close a transaction,
use the xref:drivers::rust/api-reference.adoc#_struct_Transaction_force_close__[force_close] method:

.Close a transaction
[,rust]
----
tx.force_close()
----
--

Python::
+
--
Use a https://peps.python.org/pep-0343/[context manager] to close a transaction when it's longer needed,
or use the xref:drivers::python/api-reference.adoc#_TypeDBTransaction_close__[close] method
to explicitly close a transaction:

.Close a transaction
[,python]
----
tx.close()
----
--

Java::
+
--
Use the https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html[Try with resources] statement
to close a transaction when it's longer needed, or use the
xref:drivers::java/api-reference.adoc#_TypeDBTransaction_close__[close] method to explicitly close a transaction:

.Close a transaction
[,java]
----
tx.close()
----
--

Node.js::
+
--
Use the xref:drivers::nodejs/api-reference.adoc#_TypeDBTransaction_close__[close] method
to explicitly close a transaction:

.Close a transaction
[,js]
----
tx.close();
----
--

C++::
+
--
A transaction is automatically closed when the variable containing it is dropped from memory.

To explicitly close a transaction,
use the xref:drivers::cpp/api-reference.adoc#_void_TypeDBTransactionclose[close] method:

.Close a transaction
[,cpp]
----
tx.close();
----
--
====

[#_commit_a_transaction]
=== Commit a transaction

Committing a transaction validates and applies changes to the database.
A successful commit persists all changes made within a transaction and then closes the transaction.
A commit can fail if an inconsistency arises, like a concurrent modifications by another successful commit.
A failed commit closes the transaction.

To commit a transaction, follow the steps below:

[tabs]
====
Studio::
+
--
In the top toolbar click the btn:[Commit Transaction] button with a green check mark:
image:home::studio-icons/commit.png[].

The button is active only when a transaction is open.
--

Console::
+
--
Use the following command in Console's transaction input:

.Commit a transaction
[,bash]
----
commit
----
--
====

To programmatically commit a transaction, use xref:drivers::overview.adoc[TypeDB drivers]:

[tabs]
====
Rust::
+
--
To commit a transaction,
use the xref:drivers::rust/api-reference.adoc#_struct_Transaction_commit__[commit] method:

.Commit a transaction
[,rust]
----
tx.commit();
----
--

Python::
+
--
To commit a transaction, use the xref:drivers::python/api-reference.adoc#_TypeDBTransaction_commit__[commit] method:

.Commit a transaction
[,python]
----
tx.commit()
----
--

Java::
+
--
To commit a transaction, use the xref:drivers::java/api-reference.adoc#_TypeDBTransaction_commit__[commit] method:

.Commit a transaction
[,java]
----
tx.commit();
----
--

Node.js::
+
--
To commit a transaction, use the xref:drivers::nodejs/api-reference.adoc#_TypeDBTransaction_commit__[commit]:

.Commit a transaction
[,js]
----
tx.commit();
----
--

C++::
+
--
To commit a transaction, use the xref:drivers::cpp/api-reference.adoc#_void_TypeDBTransactioncommit[commit] method:

.Commit a transaction
[,cpp]
----
tx.commit();
----
--
====
