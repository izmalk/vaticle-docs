= Insert query
:experimental:
:tabs-sync-option:

An insert query is used to insert data into a TypeDB database.

This page assumes you've already followed instructions from the xref:manual::defining/define.adoc[] page.
Here, you'll see how to insert data in a database using Studio, Console, or one of the drivers.

== Sending an Insert query

The easiest way to send an Insert query is to use one of the TypeDB clients:
xref:manual::studio.adoc[Studio] or xref:manual::console.adoc[Console]:

[tabs]
====
Studio::
+
--
Follow the xref:manual::studio.adoc#_prepare_a_query[Studio manual]
to connect to TypeDB and select a project folder.
Then use the steps below:

. Use a drop-down list in the top toolbar to select a database with the name `sample_db`.
. Switch to `data` session and `write` transaction types.
. Open a new tab and insert or type in an Insert query, for example:
+
.TypeQL Insert query
[,typeql]
----
insert $u isa user, has name "Alice", has email "alice@vaticle.com";
----
. Run the query by clicking the btn:[Run query] button (image:home::studio-icons/run.png[run]).
. Commit the changes by clicking the btn:[Commit query] button (image:home::studio-icons/commit.png[Commit]).
--

Console::
+
--
. Open a session and transaction:
+
[,bash]
----
transaction sample_db schema write
----
. Send the Define query:
+
[,bash]
----
insert $u isa user, has name "Alice", has email "alice@vaticle.com";
----
+
Push btn:[Enter] twice to send the query.
. Commit the changes:
+
[,bash]
----
commit
----
////
[,bash]
----
typedb console --command="database create sample_db" \
--command="transaction sample_db schema write" \
--command="define user sub entity;" \
--command="commit"
----
////
--
====

To send a Define query programmatically, use xref:manual::installing/drivers.adoc[drivers]:

[tabs]
====
Rust::
+
--
[,rust]
----
let query = "insert $u isa user, has name 'Alice', has email 'alice@vaticle.com';";
let databases = DatabaseManager::new(driver);
let db = databases.get("sample_db")?;
let session = Session::new(db, SessionType::Data)?;
let tx = session.transaction(TransactionType::Write)?;
tx.query().insert(&query)?;
tx.commit().resolve()?;
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--

Python::
+
--
[,python]
----
with driver.session("sample_db", SessionType.DATA) as session:
    with session.transaction(TransactionType.WRITE) as transaction:
        transaction.query.insert("insert $u isa user, has name 'Alice', has email 'alice@vaticle.com';")
        transaction.commit()
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--

Java::
+
--
[,java]
----
try (TypeDBSession session = driver.session("sample_db", TypeDBSession.Type.DATA)) {
    try (TypeDBTransaction Transaction = session.transaction(TypeDBTransaction.Type.WRITE)) {
        Transaction.query().insert("insert $u isa user, has name 'Alice', has email 'alice@vaticle.com';");
        Transaction.commit();
    }
}
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--

Node.js::
+
--
[,js]
----
session = await driver.session("sample_db", SessionType.DATA);
transaction = await session.transaction(TransactionType.WRITE);
await transaction.query.insert("insert $u isa user, has name 'Alice', has email 'alice@vaticle.com';");
await transaction.commit();
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--

C++::
+
--
[,cpp]
----
TypeDB::Options options;
    {
        auto session = driver.session("sample_db", TypeDB::SessionType::DATA, options);
        auto tx = session.transaction(TypeDB::TransactionType::WRITE, options);
        (void) tx.query.define("insert $u isa user, has name 'Alice', has email 'alice@vaticle.com';", options);
        tx.commit();
    }
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--
====

== Checking the result of an insert

The `insert` clause of an Insert query is executed once per every result matched by the `match` clause.
To estimate the number of inserts,
you can run a dedicated `fetch` or `get` query right before inserting with the same `match` clause,
or check the response of the Insert query, either in Studio/Console or programmatically.

.Checking the number of matched results
[,typeql]
----
match $bob isa user, has email "bob@vaticle.com";
get; count;
----

=== Studio and Console output examples

For the <<_inserting_a_relation>> query, in case of a singular match,
the resulted output looks like this:

.Insert query response example
[tabs]
====
Studio::
+
--
.Log output
[,typeql]
----
## Result> Insert query successfully inserted new things to the database:
{
    $bob iid 0x826e80018000000000000004 isa user;
    $f iid 0x847080017fffffffffffffff (friend: iid 0x826e80018000000000000002, friend: iid 0x826e80018000000000000004) isa friendship;
    $alice iid 0x826e80018000000000000002 isa user;
}
----
--

Console::
+
--
.CLI output
[,typeql]
----
{
    $f iid 0x847080017fffffffffffffff (friend: iid 0x826e80018000000000000002, friend: iid 0x826e80018000000000000004) isa friendship;
    $alice iid 0x826e80018000000000000002 isa user;
    $bob iid 0x826e80018000000000000004 isa user;
}

answers: 1, total duration: 24 ms
----
--
====

=== Checking the response programmatically

For the <<_inserting_a_relation>> query the code to send the query and check the response looks like this:

[tabs]
====
Rust::
+
--
[,rust]
----
let query = "match $alice isa user, has email 'alice@vaticle.com'; $bob isa user, has email 'bob@vaticle.com';
            insert $f (friend: $alice, friend: $bob) isa friendship;";
let databases = DatabaseManager::new(driver);
let db = databases.get("sample_db")?;
let session = Session::new(db, SessionType::Data)?;
let tx = session.transaction(TransactionType::Write)?;
tx.query().insert(&query)?;
tx.commit().resolve()?;
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--

Python::
+
--
[,python]
----
query = "match $alice isa user, has email 'alice@vaticle.com';" \
        $bob isa user, has email 'bob@vaticle.com';" \
        insert $f (friend: $alice, friend: $bob) isa friendship;"
with driver.session("sample_db", SessionType.DATA) as session:
    with session.transaction(TransactionType.WRITE) as transaction:
        transaction.query.insert(query)
        transaction.commit()
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--

Java::
+
--
[,java]
----
String query = """
                match $alice isa user, has email 'alice@vaticle.com'; $bob isa user, has email 'bob@vaticle.com';
                insert $f (friend: $alice, friend: $bob) isa friendship;
                """;
try (TypeDBSession session = driver.session("sample_db", TypeDBSession.Type.DATA)) {
    try (TypeDBTransaction Transaction = session.transaction(TypeDBTransaction.Type.WRITE)) {
        Transaction.query().insert(query);
        Transaction.commit();
    }
}
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--

Node.js::
+
--
[,js]
----
const query =  `match $alice isa user, has email 'alice@vaticle.com'; $bob isa user, has email 'bob@vaticle.com';
                insert $f (friend: $alice, friend: $bob) isa friendship;
                `;
session = await driver.session("sample_db", SessionType.DATA);
transaction = await session.transaction(TransactionType.WRITE);
await transaction.query.insert(query);
await transaction.commit();
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--

C++::
+
--
[,cpp]
----
std::string query = "match $alice isa user, has email 'alice@vaticle.com'; $bob isa user, has email 'bob@vaticle.com';
                    insert $f (friend: $alice, friend: $bob) isa friendship;";
TypeDB::Options options;
    {
        auto session = driver.session("sample_db", TypeDB::SessionType::DATA, options);
        auto tx = session.transaction(TypeDB::TransactionType::WRITE, options);
        (void) tx.query.define(query, options);
        tx.commit();
    }
----

Where `driver` is an instance of a driver, xref:manual::connecting/connection.adoc[connected] to TypeDB.
--
====
